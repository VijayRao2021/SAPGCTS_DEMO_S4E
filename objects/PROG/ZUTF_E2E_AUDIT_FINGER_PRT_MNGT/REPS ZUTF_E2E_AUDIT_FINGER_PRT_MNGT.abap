REPORT zutf_e2e_audit_finger_prt_mngt NO STANDARD PAGE HEADING LINE-SIZE 132.
****************************************************************************************************
* FLOW         : E2E Framework interfaces oversight                                                *
*--------------------------------------------------------------------------------------------------*
* AIM          : Manage the ZE2E_FINGER_PRT table                                                  *
*                                                                                                  *
*--------------------------------------------------------------------------------------------------*
* Author       :  D. CRESSON                                                                       *
* Creation Date:  25.02.2016                                                                       *
****************************************************************************************************

****************************************************************************************************
*                                      MODIFICATIONS HISTORIC                                      *
*------------+------------+------------------------------------------------------------------------*
*   Author   !    Date    !                             Modification                               *
*------------+------------+------------------------------------------------------------------------*
*            !            !                                                                        *
*            !            !                                                                        *
****************************************************************************************************


****************************************************************************************************
*                                            CONSTANTS                                             *
****************************************************************************************************
*CONSTANTS:

****************************************************************************************************
*                                            SAP TABLES                                            *
****************************************************************************************************
*TABLES:

****************************************************************************************************
*                                   STRUCTURES AND INTERN TABLES                                   *
****************************************************************************************************
*DATA:


****************************************************************************************************
*                                             VARIABLES                                            *
****************************************************************************************************
DATA:
 go_log TYPE REF TO z_cl_UTF_log.
****************************************************************************************************
*                                         SELECTION SCREEN                                         *
****************************************************************************************************
*Selection criterion block
SELECTION-SCREEN BEGIN OF BLOCK b01 WITH FRAME TITLE TEXT-b01.
  PARAMETERS: p_rettim TYPE i DEFAULT 30.
SELECTION-SCREEN END OF BLOCK b01.

****************************************************************************************************
START-OF-SELECTION.
****************************************************************************************************
  "Configure log system
  CREATE OBJECT go_log.
  go_log->set_log_level( 5 ).
  SET HANDLER go_log->add_log.

  PERFORM cleaning.
****************************************************************************************************
END-OF-SELECTION.
****************************************************************************************************

*--------------------------------------------- REPORT ---------------------------------------------*
  go_log->write_log( ).
*****************************************     INCLUDES     *****************************************


****************************************************************************************************
*                                               FORMS                                              *
****************************************************************************************************
FORM cleaning.
  DATA:
        lv_date TYPE sydatum.

  go_log->add_log( iv_group = 'CLEANING' iv_level = 0 iv_type = 'H' iv_msg1 = 'Start ZE2E_FINGER_PRT cleaning...'(h01) ).
  lv_date = sy-datum - p_rettim.
  go_log->add_log( iv_group = 'CLEANING' iv_level = 1 iv_type = 'I' iv_msg1 = '&2 days of retention so delete until &3'(i01) iv_msg2 = p_rettim iv_msg3 = lv_date ).
  DELETE FROM ze2e_finger_prt WHERE receiving_date < lv_date.
  go_log->add_log( iv_group = 'CLEANING' iv_level = 1 iv_type = 'I' iv_msg1 = '&2 lines deleted'(i02) iv_msg2 = sy-dbcnt ).
ENDFORM.